{"version":3,"sources":["job/util/performerToID.js"],"names":["getID","async","require","list","cb","idsList","eachSeries","item","next","findOne","name","then","res","push","_id","create","type","link","active","err"],"mappings":";;;;;QAKgBA,K,GAAAA,K;;AAFhB;;;;;;AACA,IAAIC,QAAQC,QAAQ,OAAR,CAAZ,C,CAJA;;;AAKO,SAASF,KAAT,CAAeG,IAAf,EAAqBC,EAArB,EAAyB;AAC9B,MAAIC,UAAU,EAAd;AACA;AACAJ,QAAMK,UAAN,CAAiBH,IAAjB,EACE,UAAUI,IAAV,EAAgBC,IAAhB,EAAsB;AACpB,wBAAUC,OAAV,CAAkB,EAACC,MAAMH,KAAKG,IAAZ,EAAlB,EACGC,IADH,CACQ,UAAUC,GAAV,EAAe;AACnB,UAAIA,QAAM,IAAV,EAAgB;AACdP,gBAAQQ,IAAR,CAAaD,IAAIE,GAAjB;AACAN;AACD,OAHD,MAGO;AACL,4BAAUO,MAAV,CAAiB;AACfC,gBAAMT,KAAK,OAAL,CADS;AAEfG,gBAAMH,KAAK,MAAL,CAFS;AAGfU,gBAAMV,KAAK,QAAL,CAHS;AAIfW,kBAAQ;AAJO,SAAjB,EAMGP,IANH,CAMQ,UAAUC,GAAV,EAAe;AACnB;AACA;AACAP,kBAAQQ,IAAR,CAAaD,IAAIE,GAAjB;AACAN;AACD,SAXH;AAYD;AACF,KAnBH;AAoBD,GAtBH,EAuBE,UAAUW,GAAV,EAAe;AACb;AACAf,OAAG,IAAH,EAASC,OAAT;AACD,GA1BH;AA4BD","file":"job/util/performerToID.js","sourcesContent":["/**\n * Created by Pavel.Kogan on 13/08/2016.\n */\nimport Performer from '../../api/performer/performer.model';\nvar async = require('async');\nexport function getID(list, cb) {\n  let idsList = [];\n  //console.log(list.length)\n  async.eachSeries(list,\n    function (item, next) {\n      Performer.findOne({name: item.name})\n        .then(function (res) {\n          if (res!==null) {\n            idsList.push(res._id);\n            next();\n          } else {\n            Performer.create({\n              type: item[\"@type\"],\n              name: item[\"name\"],\n              link: item[\"sameAs\"],\n              active: true\n            })\n              .then(function (res) {\n                //console.log(\"Per Created arr: \", res[0].id);\n                //console.log(\"Per Created: \", res.id);\n                idsList.push(res._id);\n                next();\n              })\n          }\n        })\n    },\n    function (err) {\n      //console.log(idsList)\n      cb(null, idsList)\n    }\n  )\n}\n\n\n"],"sourceRoot":"/source/"}